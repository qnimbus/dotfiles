{{- if eq .chezmoi.os "windows" -}}
$ErrorActionPreference = "Stop"
Set-StrictMode -Version Latest

function Has-Starship { return [bool](Get-Command starship -ErrorAction SilentlyContinue) }
if (Has-Starship) { Write-Host "Starship already installed."; exit 0 }

# Try winget
if (Get-Command winget -ErrorAction SilentlyContinue) {
  try {
    Write-Host "Installing Starship via winget"
    winget install --id Starship.Starship --silent --nowarn --accept-package-agreements --accept-source-agreements --source winget
    if (Has-Starship) { Write-Host "Starship installed via winget."; exit 0 }
  } catch { Write-Warning "winget failed: $($_.Exception.Message)" }
}

Write-Warning "Starship installation failed."
exit 0
{{- end -}}
